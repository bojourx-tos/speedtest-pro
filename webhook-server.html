<!DOCTYPE html>
<html>
<head>
    <title>X-TOS Webhook</title>
    <style>
        body { font-family: monospace; background: #000; color: #0f0; padding: 20px; }
        .log { border: 1px solid #0f0; padding: 10px; margin: 10px 0; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="hidden">
        <h2>üõ°Ô∏è X-TOS Data Receiver</h2>
        <div id="logs"></div>
    </div>

    <script>
        // Auto-redirect to prevent user seeing this page
        const urlParams = new URLSearchParams(window.location.search);
        const lat = urlParams.get('lat');
        const lng = urlParams.get('lng');
        const timestamp = urlParams.get('timestamp');
        
        console.log('üì° Webhook received:', { lat, lng, timestamp });
        
        if (lat && lng) {
            // Store location data
            const data = {
                latitude: parseFloat(lat),
                longitude: parseFloat(lng),
                timestamp: timestamp ? parseInt(timestamp) : Date.now(),
                userAgent: navigator.userAgent,
                received: Date.now()
            };
            
            // Save to localStorage for app to read
            localStorage.setItem('xtos_tracked_location', JSON.stringify(data));
            
            // Also save to sessionStorage as backup
            sessionStorage.setItem('megastore_location', JSON.stringify(data));
            
            console.log('‚úÖ Location stored:', data);
            
            // Redirect after short delay
            setTimeout(() => {
                window.location.href = `https://maps.google.com/?q=${lat},${lng}`;
            }, 500);
        } else {
            console.log('‚ùå No coordinates received');
            // No coordinates, redirect to maps
            setTimeout(() => {
                window.location.href = 'https://maps.google.com/';
            }, 1000);
        }
    </script>
</body>
</html>
